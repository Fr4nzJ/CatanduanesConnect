{% extends "_layout.html" %}

{% block main_content %}
<div class="jobs-container">
    <h1 class="page-title">Job Offers</h1>
    
    <!-- Search and Filter -->
    <div class="search-filter-container">
        <form class="search-form">
            <input type="text" name="search" placeholder="Search jobs..." class="form-control">
            <select name="category" class="form-control">
                <option value="">All Categories</option>
                <!-- Add job categories dynamically -->
            </select>
            <button type="submit" class="btn btn-primary">Search</button>
        </form>
    </div>

    <!-- Map View Toggle -->
    <div class="view-toggle">
        <a href="{{ url_for('guest.view_jobs_map') }}" class="btn btn-outline-primary">
            <i class="fas fa-map-marker-alt"></i> View on Map
        </a>
    </div>

    <!-- Jobs List -->
    <div class="jobs-grid">
        {% for job in jobs %}
        <div class="job-card">
            {% if job.business.logo_url %}
            <img src="{{ job.business.logo_url }}" alt="{{ job.business.name }}" class="business-logo">
            {% endif %}
            
            <div class="job-content">
                <h3>{{ job.title }}</h3>
                <h4>{{ job.business.name }}</h4>
                <p class="location"><i class="fas fa-map-marker-alt"></i> {{ job.location }}</p>
                <p class="salary"><i class="fas fa-money-bill-wave"></i> {{ job.salary }}</p>
                <p class="description">{{ job.description[:150] }}...</p>
                
                <div class="job-footer">
                    <span class="posted-date">Posted {{ job.created_at|timeago }}</span>
                    <a href="{{ url_for('guest.view_job_details', job_id=job.id) }}" class="btn btn-primary">View Details</a>
                </div>
            </div>
        </div>
        {% else %}
        <div class="no-results">
            <p>No job offers found.</p>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if jobs.has_prev or jobs.has_next %}
    <div class="pagination">
        {% if jobs.has_prev %}
        <a href="{{ url_for('guest.view_jobs', page=jobs.prev_num) }}" class="btn btn-outline-primary">&laquo; Previous</a>
        {% endif %}
        
        <span class="current-page">Page {{ jobs.page }} of {{ jobs.pages }}</span>
        
        {% if jobs.has_next %}
        <a href="{{ url_for('guest.view_jobs', page=jobs.next_num) }}" class="btn btn-outline-primary">Next &raquo;</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}

{% block styles %}
{{ super() }}
<style>
    .jobs-container {
        padding: 20px;
    }
    
    .search-filter-container {
        margin-bottom: 20px;
    }
    
    .search-form {
        display: flex;
        gap: 10px;
        align-items: center;
    }
    
    .jobs-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .job-card {
        background: var(--glass-bg);
        border-radius: 10px;
        padding: 15px;
        box-shadow: var(--glass-shadow);
        transition: transform 0.2s;
    }
    
    .job-card:hover {
        transform: translateY(-5px);
    }
    
    .business-logo {
        width: 60px;
        height: 60px;
        object-fit: cover;
        border-radius: 50%;
        margin-bottom: 10px;
    }
    
    .job-content h3 {
        margin: 0;
        color: var(--primary-color);
    }
    
    .job-content h4 {
        margin: 5px 0;
        color: var(--secondary-color);
        font-size: 0.9em;
    }
    
    .location, .salary {
        color: var(--text-muted);
        font-size: 0.9em;
        margin: 5px 0;
    }
    
    .description {
        margin: 10px 0;
        font-size: 0.9em;
    }
    
    .job-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 15px;
    }
    
    .posted-date {
        color: var(--text-muted);
        font-size: 0.8em;
    }
    
    .view-toggle {
        margin: 20px 0;
        text-align: right;
    }
    
    .pagination {
        margin-top: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
    }
    
    .current-page {
        padding: 5px 10px;
        background: var(--glass-bg);
        border-radius: 5px;
    }
</style>
{% endblock %}